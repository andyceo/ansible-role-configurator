---

- name: Create directories tree
  file:
    path={{ item.dir }}
    mode={{ item.mode|default(configurator.default.directory.mode) }}
    owner={{ item.owner|default(configurator.default.directory.owner) }}
    group={{ item.group|default(configurator.default.directory.group) }}
    state=directory
  with_items: "{{ configurator.directories }}"
  notify: "{{ item.notify|default(configurator.default.directory.notify) }}"

- name: Copy files
  copy:
    dest={{ item.file }}
    src={{ item.src }}
    mode={{ item.mode|default(configurator.default.file.mode) }}
    owner={{ item.owner|default(configurator.default.file.owner) }}
    group={{ item.group|default(configurator.default.file.group) }}
    force={{ item.force|default(configurator.default.file.force) }}
  with_items: "{{ configurator.files }}"
  notify: "{{ item.notify|default(configurator.default.file.notify) }}"

- name: Create symlinks with force mode
  file:
    dest={{ item.dest }}
    src={{ item.src }}
    force={{ item.force|default(configurator.default.symlink.force) }}
    state=link
  with_items: "{{ configurator.symlinks }}"
  when: "item.force"
  notify: "{{ item.notify|default(configurator.default.symlink.notify) }}"

- name: Create symlinks without force mode
  command: ln -s {{ item.src }} {{ item.dest }}
    creates={{ item.dest }}
    chdir={{ item.chdir|default('.') }}
  with_items: "{{ configurator.symlinks }}"
  when: "not item.force"
  notify: "{{ item.notify|default(configurator.default.symlink.notify) }}"
